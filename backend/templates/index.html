<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Post Station</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>Welcome to the Post Station</h1>
    <form action="/access-post" method="GET" class="ledger-form">
            <div class="access-pair">
                <label for="waybill">Waybill ID</label>
                <input type="text" id="waybill" name="waybill" placeholder="afjkhweifo" required>
                <label for="key">Courier Key</label>
                <input type="password" id="key" name="key" placeholder="••••••••" required>
            </div>
            <button type="submit" class="btn-search">Locate Post</button>
        </form>
    <form action="/post-letter" method="POST" enctype="multipart/form-data">
        <div>
            <label>Access Ids:</label><br>
        <div class="access-ids">
            <input type="text" name="waybill-ids" placeholder="John Doe" required>
            <input type="password" name="key" placeholder="afjwh" required>
        </div>
        <div class="error">
            <!--error message-->
        </div>
        <div class="access-controls">
            <button type="button" onclick="addAccessIds()">+ Add</button>
            <button type="button" onclick="removeAccessIds()" style="color: #e74c3c;">- Remove</button>
        </div>
        </div>
        
        

        <div>
            <label>Message:</label><br>
            <textarea name="message" rows="5" required></textarea>
        </div>

        <div>
            <label>Images:</label><br>
            <input type="file" name="images" accept="image/*" multiple>
        </div>

        <div>
            <label>Attachments:</label><br>
            <input type="file" name="attachments" multiple>
        </div>

        <br>
        <button type="submit">Send Post</button>
    </form>
</body>
<script type="text/javascript">
    function addAccessIds() {
        const accessDiv = document.querySelector('.access-ids');
        const error = document.querySelector('.error');
        //clear if there war an error
        error.innerHTML = '';
        if (accessDiv.children.length >= 16) {// 8 *2 = 16
            //alert('You can only add up to 8 recipients');
            error.innerHTML = 'You can only add up to 8 access ids';
            error.style.color = 'red';
            return;
        }
        const input = document.createElement('input');
        input.type = 'text';
        input.name = 'waybill-ids';
        input.placeholder = 'John Doe';
        input.required = true;

        const k = document.createElement('input');
        k.type = 'password';
        k.name = 'key';
        k.placeholder = 'afjwh';
        k.required = true;

        accessDiv.appendChild(input);
        accessDiv.appendChild(k);
    }
    function removeAccessIds() {
        const accessDiv = document.querySelector('.access-ids');
        const error = document.querySelector('.error');
        error.innerHTML = '';//clear previous error
        //dont remove if only one
        if (accessDiv.children.length <= 2) {//pairs of id and key
            //alert('You must have at least one recipient');
            error.innerHTML = 'You must have at least one access id';
            error.style.color = 'red';
            return;
        }
        accessDiv.removeChild(accessDiv.lastElementChild);
        accessDiv.removeChild(accessDiv.lastElementChild);
    }
</script>
</html>